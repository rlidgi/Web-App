<!-- filepath: templates/my_revisions.html -->
<!DOCTYPE html>
<html lang="en">
<script defer src="/static/js/script.js"></script>

<head>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KRPLMCR73G"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-KRPLMCR73G');
    </script>

    <script defer>
        (function (c, l, a, r, i, t, y) {
            c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
            t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i + "?ref=bwt";
            y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
        })(window, document, "clarity", "script", "sjihir10df");
    </script>


    <!-- TrustBox script -->
    <script type="text/javascript" src="//widget.trustpilot.com/bootstrap/v5/tp.widget.bootstrap.min.js" async></script>
    <!-- End TrustBox script -->


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Access and manage all your AI-enhanced resume revisions in one place. Download, view, and track your resume improvements with ResumaticAI.">
    <title>{% if user and user.name and user.name.strip() %}{{ user.name.split()[0] }}'s{% else %}My{% endif %} Resume
        Revisions - Resumatic AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        'primary-dark': '#2563EB'
                    }
                }
            }
        }        // Toggle notes display/edit mode
        function toggleNotes(revisionId) {
            const displayDiv = document.getElementById(`notes-display-${revisionId}`);
            const editDiv = document.getElementById(`notes-edit-${revisionId}`);
            const emptyDiv = document.getElementById(`notes-empty-${revisionId}`);

            if (displayDiv.classList.contains('hidden')) {
                // Currently in edit mode, show display mode
                displayDiv.classList.remove('hidden');
                editDiv.classList.add('hidden');
                if (emptyDiv) emptyDiv.classList.add('hidden');
            } else {
                // Currently in display mode, show edit mode
                displayDiv.classList.add('hidden');
                editDiv.classList.remove('hidden');
                if (emptyDiv) emptyDiv.classList.add('hidden');
            }
        }        // Convert UTC timestamps to local timezone
        function convertToLocalTime() {
            // Convert date-only elements (for stats)
            document.querySelectorAll('.local-date').forEach(element => {
                const utcDate = element.getAttribute('data-utc-date');
                if (utcDate && utcDate.trim()) {
                    try {
                        const date = new Date(utcDate);
                        if (!isNaN(date.getTime())) {
                            const localDate = date.toLocaleDateString('en-US', {
                                month: 'numeric',
                                day: 'numeric'
                            });
                            element.textContent = localDate;
                        }
                    } catch (e) {
                        console.log('Error parsing date:', utcDate);
                    }
                }
            });

            // Convert full datetime elements (for revision entries)
            document.querySelectorAll('.local-datetime').forEach(element => {
                const utcDate = element.getAttribute('data-utc-date');
                if (utcDate && utcDate.trim()) {
                    try {
                        const date = new Date(utcDate);
                        if (!isNaN(date.getTime())) {
                            const localDateTime = date.toLocaleDateString('en-US', {
                                year: 'numeric',
                                month: 'long',
                                day: 'numeric'
                            }) + ' at ' + date.toLocaleTimeString('en-US', {
                                hour: 'numeric',
                                minute: '2-digit',
                                hour12: true
                            });
                            element.textContent = localDateTime;
                        }
                    } catch (e) {
                        console.log('Error parsing datetime:', utcDate);
                    }
                }
            });
        }

        // Convert timestamps when page loads
        document.addEventListener('DOMContentLoaded', convertToLocalTime);
    </script>
    <style>
        .card-hover {
            transition: all 0.3s ease;
        }

        .card-hover:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .btn-primary {
            background: linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%);
        }

        /* Mobile menu styles */
        .mobile-menu {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }

        .mobile-menu.active {
            transform: translateX(0);
        }

        .nav-link {
            position: relative;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -4px;
            left: 0;
            background-color: #3B82F6;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen font-sans"
    style="background-image: url('/static/images/bg13.png'); background-size: cover; background-repeat: no-repeat; background-attachment: fixed;">

    <!-- Download Feedback Modal -->
    <div id="downloadFeedbackModal" class="fixed inset-0 bg-black/60 z-[9999] hidden items-center justify-center p-4">
        <div class="bg-white w-full max-w-md rounded-2xl shadow-2xl overflow-hidden">
            <div class="flex items-center justify-between px-5 py-4 border-b">
                <h3 class="font-semibold text-lg text-gray-800">How was your resume?</h3>
                <button id="downloadFeedbackClose" class="text-gray-500 hover:text-gray-800" aria-label="Close">&times;</button>
            </div>
            <div class="p-5 space-y-4">
                <p class="text-sm text-gray-600">Your feedback helps us improve ResumaticAI.</p>
                <div class="space-y-2">
                    <div class="text-sm font-medium text-gray-800">Overall, how satisfied are you?</div>
                    <div id="downloadStars" class="flex items-center gap-1" role="radiogroup" aria-label="Rating">
                        <input type="radio" name="download_rating" id="download_rating_1" value="1" class="hidden">
                        <label for="download_rating_1" data-value="1" class="cursor-pointer text-gray-300 text-2xl p-1">
                            <i class="fas fa-star"></i>
                        </label>
                        <input type="radio" name="download_rating" id="download_rating_2" value="2" class="hidden">
                        <label for="download_rating_2" data-value="2" class="cursor-pointer text-gray-300 text-2xl p-1">
                            <i class="fas fa-star"></i>
                        </label>
                        <input type="radio" name="download_rating" id="download_rating_3" value="3" class="hidden">
                        <label for="download_rating_3" data-value="3" class="cursor-pointer text-gray-300 text-2xl p-1">
                            <i class="fas fa-star"></i>
                        </label>
                        <input type="radio" name="download_rating" id="download_rating_4" value="4" class="hidden">
                        <label for="download_rating_4" data-value="4" class="cursor-pointer text-gray-300 text-2xl p-1">
                            <i class="fas fa-star"></i>
                        </label>
                        <input type="radio" name="download_rating" id="download_rating_5" value="5" class="hidden">
                        <label for="download_rating_5" data-value="5" class="cursor-pointer text-gray-300 text-2xl p-1">
                            <i class="fas fa-star"></i>
                        </label>
                    </div>
                    <div id="downloadStarText" class="text-xs text-gray-500 mt-1 h-4"></div>
                    <div class="mt-3 space-y-2">
                        <div class="text-sm font-medium text-gray-800">Compared to your original resume, this is:</div>
                        <div id="downloadComparisonGroup" class="flex flex-col gap-2 sm:flex-row sm:items-center">
                            <label class="inline-flex items-center gap-2 cursor-pointer border rounded-full px-3 py-1 text-sm text-gray-700 border-gray-300 transition-colors">
                                <input type="radio" name="download_comparison" value="improved" class="accent-blue-600">
                                <span class="text-sm">Improved</span>
                            </label>
                            <label class="inline-flex items-center gap-2 cursor-pointer border rounded-full px-3 py-1 text-sm text-gray-700 border-gray-300 transition-colors">
                                <input type="radio" name="download_comparison" value="same" class="accent-blue-600">
                                <span class="text-sm">About the same</span>
                            </label>
                            <label class="inline-flex items-center gap-2 cursor-pointer border rounded-full px-3 py-1 text-sm text-gray-700 border-gray-300 transition-colors">
                                <input type="radio" name="download_comparison" value="worse" class="accent-blue-600">
                                <span class="text-sm">Worse</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div>
                    <label for="downloadFeedbackComment" class="block text-sm font-medium text-gray-800 mb-1">Anything we could improve?</label>
                    <textarea id="downloadFeedbackComment" class="w-full border rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3" placeholder="Optional"></textarea>
                </div>
            </div>
            <div class="px-5 py-4 border-t flex items-center justify-end gap-2">
                <button id="downloadFeedbackSkip" class="px-4 py-2 text-gray-700 hover:text-gray-900">Maybe later</button>
                <button id="downloadFeedbackSubmit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Send feedback</button>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu fixed top-0 right-0 h-full w-64 bg-white shadow-lg z-50 p-6 hidden" id="mobileMenu">
        <div class="flex justify-between items-center mb-8">

            <button class="text-gray-500 hover:text-gray-900" id="closeMenu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="space-y-4">
            <a class="block text-gray-600 hover:text-primary" href="/">Home</a>
            <a class="block text-gray-600 hover:text-primary" href="/blog">Blog</a>
            <a class="block text-gray-600 hover:text-primary" href="/about">About</a>
            <a class="block text-gray-600 hover:text-primary" href="/contact">Contact</a>
            {% if user and user.is_authenticated %}
            <a class="block px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 text-center" href="/logout">
                Logout
            </a>
            {% else %}
            <a class="block px-4 py-2 bg-primary text-white rounded hover:bg-primary/90 text-center" href="/login">
                Login
            </a>
            {% endif %}
        </nav>
    </div>

    <!-- Main Navigation -->
    <header role="banner">
        <nav aria-label="Main navigation" class="bg-white shadow-sm sticky top-0 z-50" role="navigation">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-20 items-center">
                    <div class="flex items-center">
                        <a class="flex items-center" href="/">

                            <span class="sr-only">Resumatic AI</span>
                        </a>
                    </div>
                    <div class="hidden md:flex items-center space-x-8">
                        <a class="nav-link text-gray-600 hover:text-primary transition-colors" href="/">Home</a>
                        <a class="nav-link text-gray-600 hover:text-primary transition-colors" href="/blog">Blog</a>
                        <a class="nav-link text-gray-600 hover:text-primary transition-colors" href="/about">About</a>
                        <a class="nav-link text-gray-600 hover:text-primary transition-colors"
                            href="/contact">Contact</a>
                        {% if user and user.is_authenticated %}
                        <a href="/logout" class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90">
                            Logout
                        </a>
                        {% else %}
                        <a href="/login" class="px-4 py-2 bg-primary text-white rounded hover:bg-primary/90">
                            Login
                        </a>
                        {% endif %}
                    </div>
                    <button aria-expanded="false" aria-label="Toggle menu"
                        class="md:hidden text-gray-600 hover:text-gray-900" id="menuButton">
                        <i aria-hidden="true" class="fas fa-bars"></i>
                    </button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Header Section -->
    <div class="bg-white/90 backdrop-blur-sm shadow-sm sticky top-0 z-10">
        <div class="max-w-6xl mx-auto px-4 py-4">
            <div class="flex items-center">
                <div class="flex items-center space-x-3">
                    <div
                        class="w-10 h-10 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-file-alt text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">
                            {% if user and user.name and user.name.strip() %}{{ user.name.split()[0] }}'s{% else %}My{%
                            endif %} Resume Revisions
                        </h1>
                        <p class="text-sm text-gray-600">Track your resume improvement journey</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="max-w-5xl mx-auto px-6 mt-4">
        {% for category, message in messages %}
        <div
            class="mb-4 p-4 rounded-lg {% if category == 'success' %}bg-green-100 border border-green-400 text-green-700{% else %}bg-red-100 border border-red-400 text-red-700{% endif %}">
            <div class="flex items-center">
                <i
                    class="fas {% if category == 'success' %}fa-check-circle{% else %}fa-exclamation-circle{% endif %} mr-2"></i>
                {{ message }}
            </div>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="max-w-5xl mx-auto p-6">
        {% if revisions %} <!-- Stats Section -->
        <div class="mb-8">
            <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="text-center">
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-800">{{ revisions|length }}</div>
                        <div class="text-sm text-gray-600">Total Revisions</div>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-clock text-blue-600 text-xl"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-800">
                            {% if revisions %}
                            <span class="local-date"
                                data-utc-date="{{ revisions[0].timestamp.isoformat() if revisions[0].timestamp else '' }}">
                                {{ revisions[0].timestamp.strftime('%m/%d') if revisions[0].timestamp else 'N/A' }}
                            </span>
                            {% else %}
                            N/A
                            {% endif %}
                        </div>
                        <div class="text-sm text-gray-600">Latest Revision</div>
                    </div>
                    <div class="text-center">
                        <div class="w-12 h-12 bg-amber-100 rounded-lg flex items-center justify-center mx-auto mb-3">
                            <i class="fas fa-sticky-note text-amber-600 text-xl"></i>
                        </div>
                        <div class="text-2xl font-bold text-gray-800">
                            {{ revisions|selectattr('notes')|list|length }}
                        </div>
                        <div class="text-sm text-gray-600">With Job Notes</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- New Feature Highlight -->
        <div class="mb-6">
            <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-xl p-4">
                <div class="flex items-start space-x-3">
                    <div class="flex-shrink-0">
                        <div class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-sparkles text-amber-600 text-sm"></i>
                        </div>
                    </div>
                    <div class="flex-1">
                        <h4 class="text-sm font-semibold text-amber-800 mb-1">
                            <i class="fas fa-sticky-note mr-1"></i>
                            New Feature: Job Application Notes
                        </h4>
                        <p class="text-xs text-amber-700 leading-relaxed">
                            You can now add notes to each resume revision to track which job applications you used it
                            for.
                            This is the best way to stay organized, measure the effectiveness of different resume
                            versions,
                            and prepare for future interviews with the specific resume you submitted for each role.
                        </p>
                    </div>
                    <div class="flex-shrink-0">
                        <span
                            class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-amber-100 text-amber-800">
                            NEW
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Revisions List -->
        <div class="space-y-4">
            {% for rev in revisions %}
            <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-lg card-hover overflow-hidden">
                <div class="p-6">
                    <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                        <!-- Left side - Info -->
                        <div class="flex items-start space-x-4">
                            <div
                                class="w-12 h-12 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-file-alt text-white text-lg"></i>
                            </div>
                            <div class="flex-1">
                                <div class="flex items-center space-x-3 mb-2">
                                    <h3 class="text-lg font-semibold text-gray-800">Resume Revision</h3>
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <i class="fas fa-circle text-green-400 text-xs mr-1"></i>
                                        Completed
                                    </span>
                                </div>
                                <div class="flex flex-col sm:flex-row sm:items-center text-sm text-gray-600">
                                    <div class="flex items-center">
                                        <i class="fas fa-calendar-alt mr-2 text-gray-400"></i>
                                        {% if rev.timestamp %}
                                        <span class="local-datetime" data-utc-date="{{ rev.timestamp.isoformat() }}"
                                            title="Time shown in your local timezone">
                                            {{ rev.timestamp.strftime('%B %d, %Y at %I:%M %p') }}
                                        </span>
                                        {% else %}
                                        <span class="text-gray-500">Unknown date</span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right side - Actions -->
                        <div class="flex flex-col sm:flex-row gap-3">
                            <a href="/download_revision/{{ rev.revision_id }}"
                                class="inline-flex items-center justify-center px-4 py-2 btn-primary text-white rounded-lg hover:shadow-lg transition-all duration-200 font-medium">
                                <i class="fas fa-download mr-2"></i>
                                Download Resume
                            </a>
                            <a href="/view_revision/{{ rev.revision_id }}"
                                class="inline-flex items-center justify-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors duration-200 font-medium">
                                <i class="fas fa-eye mr-2"></i>
                                View Analysis
                            </a>
                        </div>
                    </div>

                    <!-- Notes Section -->
                    <div class="mt-4 pt-4 border-t border-gray-200">
                        <div class="flex items-center justify-between mb-3">
                            <h4 class="text-sm font-medium text-gray-700 flex items-center">
                                <i class="fas fa-sticky-note mr-2 text-amber-500"></i>
                                Job Application Notes
                            </h4>
                            <button onclick="toggleNotes('{{ rev.revision_id }}')"
                                class="text-xs text-blue-600 hover:text-blue-800 font-medium">
                                <i class="fas fa-edit mr-1"></i>
                                {% if rev.notes %}Edit{% else %}Add Notes{% endif %}
                            </button>
                        </div>

                        <!-- Display Notes -->
                        <div id="notes-display-{{ rev.revision_id }}" class="{% if not rev.notes %}hidden{% endif %}">
                            <div class="bg-amber-50 border border-amber-200 rounded-lg p-3">
                                <p class="text-sm text-gray-700 whitespace-pre-wrap">{{ rev.notes or 'No notes added
                                    yet.' }}</p>
                            </div>
                        </div>

                        <!-- Edit Notes Form (initially hidden) -->
                        <div id="notes-edit-{{ rev.revision_id }}" class="{% if rev.notes %}hidden{% endif %}">
                            <form action="/update_notes/{{ rev.revision_id }}" method="POST" class="space-y-3">
                                <textarea name="notes"
                                    placeholder="Add notes about job applications this resume was used for... (e.g., 'Applied to Google SWE role - 01/15/2025, Microsoft PM position - 01/20/2025')"
                                    class="w-full p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"
                                    rows="3">{{ rev.notes }}</textarea>
                                <div class="flex justify-end space-x-2">
                                    <button type="button" onclick="toggleNotes('{{ rev.revision_id }}')"
                                        class="px-3 py-1.5 text-sm text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors">
                                        Cancel
                                    </button>
                                    <button type="submit"
                                        class="px-3 py-1.5 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700 transition-colors">
                                        <i class="fas fa-save mr-1"></i>
                                        Save Notes
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Empty state when no notes -->
                        {% if not rev.notes %}
                        <div id="notes-empty-{{ rev.revision_id }}" class="text-center py-2">
                            <p class="text-xs text-gray-500 italic">
                                <i class="fas fa-info-circle mr-1"></i>
                                Add notes to track which jobs you applied to with this version
                            </p>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- Call to Action -->
        <div class="mt-8 text-center">
            <div class="bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl p-6 text-white">
                <h3 class="text-xl font-bold mb-2">Want to improve your resume further?</h3>
                <p class="text-blue-100 mb-4">Get AI-powered suggestions and create a new revision today.</p>
                <a href="/"
                    class="inline-flex items-center px-6 py-3 bg-white text-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-colors">
                    <i class="fas fa-plus mr-2"></i>
                    Create New Revision
                </a>
            </div>
        </div>

        {% else %}
        <!-- Empty State -->
        <div class="text-center py-16">
            <div class="max-w-md mx-auto">
                <div
                    class="w-24 h-24 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fas fa-file-alt text-white text-3xl"></i>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">
                    {% if user and user.name and user.name.strip() %}{{ user.name.split()[0] }}, you have{% else %}You
                    have{% endif %} no revisions yet
                </h2>
                <p class="text-gray-600 mb-8 leading-relaxed">
                    {% if user and user.name and user.name.strip() %}{{ user.name.split()[0] }}, you{% else %}You{%
                    endif %} haven't created any resume revisions yet. Start by uploading your resume and let our AI
                    help you
                    improve it!
                </p>
                <div class="space-y-4">
                    <a href="/?scroll_to_form=true#resume-form"
                        class="inline-flex items-center px-6 py-3 btn-primary text-white rounded-lg font-semibold hover:shadow-lg transition-all duration-200">
                        <i class="fas fa-upload mr-2"></i>
                        Submit resume
                    </a>
                    <div class="text-sm text-gray-500">
                        <i class="fas fa-info-circle mr-1"></i>
                        Get instant AI-powered feedback and improvements
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Review CTA -->
    <div class="max-w-6xl mx-auto p-4 mt-12 mb-10">
        <div
            class="rounded-lg shadow-lg p-8 text-center bg-gradient-to-r from-emerald-50 to-green-50 border border-emerald-200">
            <div
                class="inline-flex items-center px-3 py-1 mb-3 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-700">
                <i class="fas fa-heart mr-1 text-emerald-600"></i>
                We value your feedback
            </div>
            <h2 class="text-2xl font-extrabold text-gray-800 mb-2">Enjoying ResumaticAI?</h2>
            <div class="flex justify-center mb-3" aria-hidden="true">
                <i class="fas fa-star text-amber-400 text-xl mx-0.5"></i>
                <i class="fas fa-star text-amber-400 text-xl mx-0.5"></i>
                <i class="fas fa-star text-amber-400 text-xl mx-0.5"></i>
                <i class="fas fa-star text-amber-400 text-xl mx-0.5"></i>
                <i class="fas fa-star text-amber-400 text-xl mx-0.5"></i>
            </div>
            <p class="text-gray-700 mb-5">If we helped, a quick Trustpilot review makes a big difference.</p>

            <!-- TrustBox widget - Review Collector -->
            <div class="trustpilot-widget" data-locale="en-US" data-template-id="56278e9abfbbba0bdcd568bc"
                data-businessunit-id="68c642f02962c7c6cf071fa0" data-style-height="52px" data-style-width="100%"
                data-token="53409e14-dcae-4ea5-8520-489b71c06646">
                <a href="https://www.trustpilot.com/review/resumaticai.com" target="_blank"
                    rel="noopener">Trustpilot</a>
            </div>
            <!-- End TrustBox widget -->
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-16 py-8 border-t border-gray-200 bg-white/80 backdrop-blur-sm">
        <div class="max-w-5xl mx-auto px-6 text-center">
            <p class="text-gray-600">
                <i class="fas fa-heart text-red-500 mr-1"></i>
                Powered by Resumatic AI - Your career advancement partner
            </p>
        </div>
    </footer>


    <script>
        // Feedback modal for my_revisions downloads (anchors), non-blocking
        (function () {
            var modal = document.getElementById('downloadFeedbackModal');
            var closeBtn = document.getElementById('downloadFeedbackClose');
            var submitBtn = document.getElementById('downloadFeedbackSubmit');
            var skipBtn = document.getElementById('downloadFeedbackSkip');
            var ratingInputs = document.querySelectorAll('input[name="download_rating"]');
            var commentInput = document.getElementById('downloadFeedbackComment');
            var starContainer = document.getElementById('downloadStars');
            var starLabels = starContainer ? starContainer.querySelectorAll('label[data-value]') : null;
            var comparisonInputs = document.querySelectorAll('input[name="download_comparison"]');
            var starText = document.getElementById('downloadStarText');
            var comparisonLabels = document.querySelectorAll('#downloadComparisonGroup > label');

            function openModal() {
                if (!modal) return;
                modal.classList.remove('hidden');
                modal.classList.add('flex');
            }
            function closeModal() {
                if (!modal) return;
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }
            function updateStars(val) {
                if (!starLabels) return;
                for (var i = 0; i < starLabels.length; i++) {
                    var starVal = parseInt(starLabels[i].getAttribute('data-value'), 10);
                    if (starVal <= val) {
                        starLabels[i].classList.remove('text-gray-300');
                        starLabels[i].classList.add('text-amber-400');
                    } else {
                        starLabels[i].classList.remove('text-amber-400');
                        starLabels[i].classList.add('text-gray-300');
                    }
                }
                updateStarText(val);
            }
            function updateStarText(val) {
                if (!starText) return;
                var map = {1:'Very dissatisfied',2:'Dissatisfied',3:'Neutral',4:'Satisfied',5:'Very satisfied'};
                var n = parseInt(val || '0', 10);
                starText.textContent = map[n] || '';
            }
            function getSelectedRating() {
                for (var i = 0; i < ratingInputs.length; i++) {
                    if (ratingInputs[i].checked) return ratingInputs[i].value;
                }
                return '';
            }
            function getSelectedComparison() {
                for (var i = 0; i < comparisonInputs.length; i++) {
                    if (comparisonInputs[i].checked) return comparisonInputs[i].value;
                }
                return '';
            }
            function sendFeedback(rating, comment) {
                try {
                    fetch('/api/feedback/download', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            rating: rating || '',
                            comment: (comment || '').slice(0, 500),
                            comparison: getSelectedComparison() || ''
                        })
                    }).catch(function () { /* ignore errors */ });
                } catch (e) { /* ignore */ }
            }

            if (starLabels && starLabels.length) {
                for (var i = 0; i < starLabels.length; i++) {
                    starLabels[i].addEventListener('click', function () {
                        var val = parseInt(this.getAttribute('data-value'), 10);
                        var radio = document.getElementById('download_rating_' + val);
                        if (radio) radio.checked = true;
                        updateStars(val);
                    });
                    starLabels[i].addEventListener('mouseenter', function () {
                        var val = parseInt(this.getAttribute('data-value'), 10);
                        updateStars(val);
                    });
                    starLabels[i].addEventListener('mouseleave', function () {
                        var selected = parseInt(getSelectedRating() || '0', 10);
                        updateStars(selected);
                    });
                }
                updateStars(parseInt(getSelectedRating() || '0', 10));
            }
            function updateComparisonStyles() {
                if (!comparisonLabels || !comparisonLabels.length) return;
                for (var i = 0; i < comparisonLabels.length; i++) {
                    var input = comparisonLabels[i].querySelector('input[name="download_comparison"]');
                    var isActive = input && input.checked;
                    comparisonLabels[i].classList.toggle('bg-blue-50', isActive);
                    comparisonLabels[i].classList.toggle('border-blue-300', isActive);
                    comparisonLabels[i].classList.toggle('text-blue-800', isActive);
                    comparisonLabels[i].classList.toggle('border-gray-300', !isActive);
                    comparisonLabels[i].classList.toggle('text-gray-700', !isActive);
                }
            }
            if (comparisonInputs && comparisonInputs.length) {
                for (var j = 0; j < comparisonInputs.length; j++) {
                    comparisonInputs[j].addEventListener('change', updateComparisonStyles);
                }
                updateComparisonStyles();
            }
            if (closeBtn) closeBtn.addEventListener('click', closeModal);
            if (skipBtn) skipBtn.addEventListener('click', closeModal);
            if (modal) {
                modal.addEventListener('click', function (e) {
                    if (e.target === modal) closeModal();
                });
            }
            if (submitBtn) {
                submitBtn.addEventListener('click', function () {
                    var rating = getSelectedRating();
                    var comment = commentInput ? commentInput.value : '';
                    sendFeedback(rating, comment);
                    closeModal();
                });
            }

            // Attach to all revision download links
            var downloadLinks = document.querySelectorAll('a[href^="/download_revision/"]');
            var lastDownloadClickTs = 0;
            function tryOpenModalAfterDelay(startTs){
                // Only open if at least ~7s passed since the click that scheduled this
                var now = Date.now();
                if ((now - startTs) >= 12000) {
                    openModal();
                }
            }
            downloadLinks.forEach(function (a) {
                a.addEventListener('click', function () {
                    // Page is login-protected; always show modal non-blocking
                    lastDownloadClickTs = Date.now();
                    setTimeout(function(){ tryOpenModalAfterDelay(lastDownloadClickTs); }, 12000);
                });
            });
        })();
    </script>

</body>

</html>